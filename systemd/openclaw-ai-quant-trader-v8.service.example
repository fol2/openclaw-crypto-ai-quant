[Unit]
Description=OpenClaw AI Quant Paper Trader Daemon (v8 parallel instance)
After=network-online.target openclaw-ai-quant-ws-sidecar-v8.service
Wants=network-online.target
Requires=openclaw-ai-quant-ws-sidecar-v8.service

[Service]
Type=simple
WorkingDirectory=$PROJECT_DIR
EnvironmentFile=-%h/.config/openclaw/ai-quant-universe-v8.env
EnvironmentFile=-%h/.config/openclaw/ai-quant-v8.env
ExecStart=$PROJECT_DIR/.venv/bin/python3 -u -m engine.daemon
Restart=always
RestartSec=5
KillMode=process

# Safety: paper only.
Environment=AI_QUANT_MODE=paper

# Use a separate lock file from production.
Environment=AI_QUANT_LOCK_PATH=$PROJECT_DIR/ai_quant_paper_v8.lock

# Strategy-mode overlay for the v8 instance (Primary = 30m/5m).
Environment=AI_QUANT_STRATEGY_MODE=primary

# Keep interval consistent for modules that still read the env var.
Environment=AI_QUANT_INTERVAL=30m
Environment=AI_QUANT_LOOKBACK_BARS=200

# Sidecar integration (separate socket from production).
Environment=AI_QUANT_WS_SOURCE=sidecar
Environment=AI_QUANT_WS_SIDECAR_SOCK=%t/openclaw-ai-quant-ws-v8.sock
Environment=AI_QUANT_MARKET_DB_PATH=$PROJECT_DIR/market_data.db
Environment=AI_QUANT_CANDLES_SOURCE=sidecar
Environment=AI_QUANT_CANDLES_DB_DIR=$PROJECT_DIR/candles_dbs

# Sidecar-only: do not fetch HL REST meta in the engine loop.
Environment=AI_QUANT_REST_ENABLE=0
Environment=AI_QUANT_REST_CANDLE_BACKFILL=0

# Debug knobs (optional, safe defaults).
Environment=AI_QUANT_NEUTRAL_AUDIT_SAMPLE_EVERY_S=600
Environment=AI_QUANT_NEUTRAL_AUDIT_SAMPLE_SYMBOLS=5

Environment=PYTHONUNBUFFERED=1

NoNewPrivileges=yes
ProtectSystem=strict
ProtectHome=read-only
PrivateTmp=yes

[Install]
WantedBy=default.target

