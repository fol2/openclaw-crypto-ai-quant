# Paper Deterministic Replay Harness

## Objective

Run the full deterministic replay workflow for the paper axis with one command.

The harness executes:

1. snapshot export + paper seed
2. backtester replay
3. state audit
4. live/backtester trade reconcile
5. live/backtester action reconcile
6. live/paper action reconcile
7. live/paper decision-trace reconcile
8. strict alignment gate

## Command

```bash
python tools/run_paper_deterministic_replay.py \
  --bundle-dir /tmp/live_replay_bundle_1h \
  --output /tmp/live_replay_bundle_1h/paper_deterministic_replay_run.json
```

Strict mode (fail if accepted residuals are present):

```bash
python tools/run_paper_deterministic_replay.py \
  --bundle-dir /tmp/live_replay_bundle_1h \
  --strict-no-residuals \
  --output /tmp/live_replay_bundle_1h/paper_deterministic_replay_run.json
```

## Bundle Shortcut

If the replay bundle was generated by `tools/build_live_replay_bundle.py`, run:

```bash
/tmp/live_replay_bundle_1h/run_09_paper_deterministic_replay.sh
```

Strict shortcut:

```bash
STRICT_NO_RESIDUALS=1 /tmp/live_replay_bundle_1h/run_09_paper_deterministic_replay.sh
```

## Output

- report JSON: `paper_deterministic_replay_run.json`
- per-step logs: `<bundle-dir>/harness_logs/*.stdout.log` and `*.stderr.log`

`ok = true` means all steps (including final strict gate) passed.
